from app.core.config import settings

# --- –ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –±–æ—Ç–∞ ---
I18N = {
    "ru": {
        "start": "–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç —à–∫–æ–ª—ã –±–æ–∫—Å–∞ ü•ä\n–ü–æ–º–æ–≥—É –∑–∞–ø–∏—Å–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞ –Ω–∞ –ø—Ä–æ–±–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ –∏ –æ—Ç–≤–µ—á—É –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã.",
        "choose_lang": "–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ / Tilni tanlang",
        "main_menu": "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
        "btn_sign": "–ó–∞–ø–∏—Å–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–Ω–æ–µ",
        "btn_back": "–ù–∞–∑–∞–¥",
        "btn_prices": "–¶–µ–Ω—ã",
        "btn_schedule": "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ",
        "btn_create_child": "–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞",
        "btn_my_children": "–ú–æ–∏ –¥–µ—Ç–∏",
        "btn_help": "–ü–æ–º–æ—â—å",
        "ask_fullname": "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç? (–§–ò–û)",
        "ask_phone": "–û—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏",
        "ask_city": "–í–∞—à –≥–æ—Ä–æ–¥/—Ä–∞–π–æ–Ω?",
        "ask_child_name": "–ò–º—è —Ä–µ–±–µ–Ω–∫–∞?",
        "ask_child_age": "–°–∫–æ–ª—å–∫–æ –ª–µ—Ç —Ä–µ–±–µ–Ω–∫—É?",
        "child_saved": "–ì–æ—Ç–æ–≤–æ! –†–µ–±—ë–Ω–æ–∫ —Å–æ—Ö—Ä–∞–Ω—ë–Ω ‚úÖ",
        "prices_text": "–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã:\n‚Ä¢ 4 –∑–∞–Ω—è—Ç–∏—è ‚Äî 300 000 —Å—É–º\n‚Ä¢ 8 –∑–∞–Ω—è—Ç–∏–π ‚Äî 520 000 —Å—É–º\n‚Ä¢ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ ‚Äî 150 000 –∑–∞ —É—Ä–æ–∫",
        "schedule_text": "–ó–∞–Ω—è—Ç–∏—è: –ü–Ω / –°—Ä / –ü—Ç ‚Äî 17:00 –¥–æ 19:00",
        "sign_when": "–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–æ–±–Ω–æ–≥–æ:",
        "sign_done": "–ó–∞–ø–∏—Å–∞–ª! –ú—ã —Å–≤—è–∂–µ–º—Å—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è üëå",
        "help_text": "–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å ‚Äî —Ç—Ä–µ–Ω–µ—Ä –æ—Ç–≤–µ—Ç–∏—Ç –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.",
        "memes_hint": "–ü–æ–∫–∞ –∂–¥—ë—Ç–µ ‚Äî –≤–æ—Ç –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π –º–µ–º üí™",
        "btn_pay": "–û–ø–ª–∞—Ç–∏—Ç—å –∫—É—Ä—Å—ã",
        "ask_parent_name": "–í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–µ –∏–º—è:",
        "hello_named": "–ü—Ä–∏–≤–µ—Ç, {name}! –Ø –±–æ—Ç —à–∫–æ–ª—ã –±–æ–∫—Å–∞ ü•ä\n–ü–æ–º–æ–≥—É –∑–∞–ø–∏—Å–∞—Ç—å —Ä–µ–±—ë–Ω–∫–∞ –Ω–∞ –ø—Ä–æ–±–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ –∏ –æ—Ç–≤–µ—á—É –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã.",
        "kid_quiz": "–°—ã–≥—Ä–∞—Ç—å –≤ –∏–≥—Ä—É",
        "kid_schedule": "–ú–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ",
        "kid_help": "–ü–æ–º–æ—â—å",
        "ask_parent_phone": "üì± –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.\n–í—ã –º–æ–∂–µ—Ç–µ –≤–≤–µ—Å—Ç–∏ –µ–≥–æ –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ:",
        "ask_phone_retry": "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ–π:",
        "btn_share_phone": "üì≤ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–æ–π –Ω–æ–º–µ—Ä",
        "link_is_for_child": "‚ö†Ô∏è –≠—Ç–∞ —Å—Å—ã–ª–∫–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ä–µ–±—ë–Ω–∫–∞, –∞ –Ω–µ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è.",
        "child_linked_parent": "‚úÖ –†–µ–±—ë–Ω–æ–∫ {name} —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –≤–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É!",
        "child_linked_child": "üëã –ü—Ä–∏–≤–µ—Ç, {name}! –¢–µ–ø–µ—Ä—å —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å –∑–∞–¥–∞–Ω–∏—è –æ—Ç —à–∫–æ–ª—ã –±–æ–∫—Å–∞.",
        "my_kids_schedule_title": "üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–∏—Ö –¥–µ—Ç–µ–π:",
        "sched_wait_payment": "‚è≥ –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —Ç—Ä–µ–Ω–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∏—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ.",
        "sched_not_set": "‚ö†Ô∏è –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–æ.",
    },
    "uz": {
        "start": "Salom! Bu boks maktabi boti ü•ä\nFarzandingizni sinov darsiga yozishda yordam beraman va savollarga javob beraman.",
        "choose_lang": "Tilni tanlang / –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫",
        "main_menu": "Asosiy menyu",
        "btn_sign": "Sinov darsiga yozish",
        "btn_back": "Orqaga",
        "btn_prices": "Narxlar",
        "btn_schedule": "Dars jadvali",
        "btn_create_child": "Bola qo'shish",
        "btn_my_children": "Bolalarim",
        "btn_help": "Yordam",
        "ask_fullname": "Ismingiz va familiyangiz?",
        "ask_phone": "Aloqa uchun telefon raqam qoldiring",
        "ask_city": "Qaysi shahar/tuman?",
        "ask_child_name": "Bolani ismi?",
        "ask_child_age": "Bolaning yoshi nechida?",
        "child_saved": "Tayyor! Bola saqlandi ‚úÖ",
        "prices_text": "Amaldagi tariflar:\n‚Ä¢ 4 dars ‚Äî 300 000 so'm\n‚Ä¢ 8 dars ‚Äî 520 000 so'm\n‚Ä¢ Individual ‚Äî darsiga 150 000",
        "schedule_text": "Darslari: Du/Chor/Juma ‚Äî 15:00 - 19:00",
        "sign_when": "Qulay vaqtni tanlang:",
        "sign_done": "Yozdim! Tasdiqlash uchun aloqaga chiqamiz üëå",
        "help_text": "Savolingizni yozing ‚Äî murabbiy tez orada javob beradi.",
        "memes_hint": "Kutar ekanmiz ‚Äî mana motivatsion mem üí™",
        "btn_pay": "Kursga to'lash",
        "ask_parent_name": "Ismingizni kiriting:",
        "kid_quiz": "O'yin o'ynash",
        "kid_help": "Yordam",
        "ask_parent_phone": "üì± Iltimos, telefon raqamingizni kiriting.\nUni qo‚Äòlda yozishingiz yoki quyidagi tugmadan foydalanishingiz mumkin:",
        "ask_phone_retry": "‚ùå Noto‚Äòg‚Äòri format. Qayta urinib ko‚Äòring yoki tugmadan foydalaning:",
        "btn_share_phone": "üì≤ Raqamimni yuborish",
        "kid_schedule": "Mening raspisaniyam",
        "hello_named": "Salom, {name}! Men boks maktabi botiman ü•ä\nFarzandingizni birinchi mashg‚Äòulotga yozishda va savollarga javob berishda yordam beraman.",
        "link_is_for_child": "‚ö†Ô∏è Bu havola ota-ona uchun emas, bola uchun mo‚Äòljallangan.",
        "child_linked_parent": "‚úÖ Bola {name} sizning akkauntingizga muvaffaqiyatli bog‚Äòlandi!",
        "child_linked_child": "üëã Salom, {name}! Endi sen boks maktabidan topshiriqlarni olasan.",
        "my_kids_schedule_title": "üìÖ Farzandlaringizning jadvali:",
        "sched_wait_payment": "‚è≥ To‚Äòlovdan keyin murabbiy jadvalni belgilaydi.",
        "sched_not_set": "‚ö†Ô∏è Jadval hali belgilanmagan.",
    }
}

def t(lang: str, key: str) -> str:
    """–ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –±–æ—Ç–∞."""
    lang = lang if lang in I18N else settings.DEFAULT_LANG
    return I18N.get(lang, I18N[settings.DEFAULT_LANG]).get(key, key)

# --- –¢–µ–∫—Å—Ç—ã –¥–ª—è —Å–∞–π—Ç–∞ (RU/UZ) ---
TX = {
    "ru": {
        "site_name": "–®–∫–æ–ª–∞ –±–æ–∫—Å–∞",
        "hero_title": "–®–∫–æ–ª–∞ –±–æ–∫—Å–∞ –≤ –¢–∞—à–∫–µ–Ω—Ç–µ",
        "hero_sub": "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∏ –≥—Ä—É–ø–ø–æ–≤—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏. –ü–µ—Ä–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ.",
        "cta_title": "–ó–∞–ø–∏—Å—å –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É",
        "name": "–ò–º—è",
        "phone": "–¢–µ–ª–µ—Ñ–æ–Ω",
        "age": "–í–æ–∑—Ä–∞—Å—Ç",
        "comment": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)",
        "send": "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
        "services": "–ù–∞—à–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
        "srv1": "–ë–æ–∫—Å –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤",
        "srv2": "–î–µ—Ç—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã",
        "srv3": "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ",
        "pricing": "–¢–∞—Ä–∏—Ñ—ã",
        "p1_title": "–†–∞–∑–æ–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ",
        "p1_desc": "60 –º–∏–Ω—É—Ç ‚Ä¢ –ü–æ–¥—Ö–æ–¥–∏—Ç –Ω–æ–≤–∏—á–∫–∞–º",
        "p2_title": "8 –∑–∞–Ω—è—Ç–∏–π",
        "p2_desc": "2 –º–µ—Å—è—Ü–∞ ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—è 20%",
        "p3_title": "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ",
        "p3_desc": "1√ó1 —Å —Ç—Ä–µ–Ω–µ—Ä–æ–º",
        "about": "–û —à–∫–æ–ª–µ",
        "about_text": "–¢—Ä–µ–Ω–µ—Ä—ã —Å –ø—Ä–æ—Ñ. –æ–ø—ã—Ç–æ–º, —É–¥–æ–±–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ, –¥—Ä—É–∂–µ–ª—é–±–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞. –ü–µ—Ä–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ –ø–æ–º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å —É—Ä–æ–≤–µ–Ω—å –∏ —Ü–µ–ª–∏.",
        "privacy_hint": "–ù–∞–∂–∏–º–∞—è ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å¬ª, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.",
        "sent_ok": "–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.",
        "sent_err": "–û—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.",
        "tg_username": "–¢–µ–ª–µ–≥—Ä–∞–º (—é–∑–µ—Ä–Ω–µ–π–º)",
    },
    "uz": {
        "site_name": "Boks maktabi",
        "hero_title": "Toshkentda boks maktabi",
        "hero_sub": "Individual va guruh mashg‚Äòulotlari. Birinchi dars ‚Äî bepul.",
        "cta_title": "Bepul darsga yozilish",
        "name": "Ism",
        "phone": "Telefon",
        "age": "Yosh",
        "comment": "Izoh (majburiy emas)",
        "send": "Yuborish",
        "services": "Yo‚Äònalishlarimiz",
        "srv1": "Yangi boshlovchilar uchun boks",
        "srv2": "Bolalar guruhlari",
        "srv3": "Individual mashg‚Äòulotlar",
        "pricing": "Narxlar",
        "p1_title": "Bir martalik dars",
        "p1_desc": "60 daqiqa ‚Ä¢ Yangi boshlovchilar uchun mos",
        "p2_title": "8 ta dars",
        "p2_desc": "2 oy ‚Ä¢ 20% tejash",
        "p3_title": "Individual",
        "p3_desc": "Murabbiy bilan 1√ó1",
        "about": "Maktab haqida",
        "about_text": "Professional murabbiylar, qulay joylashuv, do‚Äòstona muhit. Birinchi dars darajangiz va maqsadlaringizni aniqlashga yordam beradi.",
        "privacy_hint": "¬´Yuborish¬ª tugmasini bosib, maxfiylik siyosatiga rozilik bildirasiz.",
        "sent_ok": "So‚Äòrov yuborildi! Siz bilan bog‚Äòlanamiz.",
        "sent_err": "Xatolik. Qayta urinib ko‚Äòring.",
        "tg_username": "Telegram foydalanuvchi nomi",
    },
}

def pick_lang(value: str | None, default: str | None = None) -> str:
    """–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —è–∑—ã–∫ —Å–∞–π—Ç–∞ –ø–æ query/–¥–µ—Ñ–æ–ª—Ç—É –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫."""
    default = default or settings.DEFAULT_LANG or "ru"
    if not value:
        return default
    v = value.lower()
    return "uz" if v.startswith("uz") else "ru"

def get_tx(lang: str) -> dict:
    """–¢–µ–∫—Å—Ç—ã –¥–ª—è —Å–∞–π—Ç–∞ –ø–æ –∫–æ–¥—É —è–∑—ã–∫–∞."""
    return TX.get(lang, TX["ru"])